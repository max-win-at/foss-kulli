/* ================================
   Foss Kulli - Sticky Notes SPA
   ================================ */

/* CSS Custom Properties */
:root {
  --note-width: 180px;
  --note-height: 180px;
  --note-gap: 20px;
  --note-bg: #ffffa5;
  --note-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
  --fab-size: 56px;
  --fab-bg: #6200ee;
  --fab-hover: #3700b3;
  --hint-color: #b0b0b0;
  --popup-bg: #ffffff;
  --popup-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
  --overlay-bg: rgba(0, 0, 0, 0.3);
}

/* Reset & Base */
*,
*::before,
*::after {
  box-sizing: border-box;
}

.hidden {
  display: none !important;
}

html,
body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: "Roboto", sans-serif;
}

/* White Board Container */
.white-board {
  position: relative;
  width: 100%;
  height: 100%;
  background: #e1f5fe;
  /* Light blue background */
  overflow: auto;
}

/* Empty State Container */
.empty-state-container {
  position: absolute;
  top: 24px;
  left: 24px;
  display: flex;
  flex-direction: row;
  align-items: center;
  /* Vertically center items */
  justify-content: flex-start;
  /* Start from left */
  pointer-events: none;
  /* Let clicks pass through container to underlying elements if needed, but... */
  pointer-events: auto;
  /* Wait, we WANT the container to be clickable now for the stack interaction */

  user-select: none;
  z-index: 0;
  opacity: 1;
  transition: opacity 0.3s ease;
  cursor: pointer;
  /* Make the whole area clickable */
}

/* Make the note stack itself clickable too just to be safe if hint is hidden */
.note-stack {
  position: relative;
  width: 180px;
  height: 180px;
  cursor: pointer;
  transition: transform 0.1s ease;
}

.note-stack:active {
  transform: scale(0.98);
}

/* Add Hint Text */
.add-hint-text {
  position: fixed;
  bottom: 32px;
  /* Align vertically with FABs (roughly centered) */
  left: 50%;
  transform: translateX(-50%);
  font-size: 1.2rem;
  /* Reduce size slightly for cleaner look */
  font-weight: 500;
  color: #b0bec5;
  text-align: center;
  white-space: nowrap;
  z-index: 50;
  pointer-events: none;
  /* Don't block clicks */
}

@media (max-width: 600px) {
  .add-hint-text {
    font-size: 0.9rem;
  }
}

/* Note Stack Graphic */
.note-stack {
  position: relative;
  width: 180px;
  height: 180px;
}

/* Common style for note sheets in the stack */
.note-sheet {
  position: absolute;
  width: 100%;
  height: 100%;
  background: #ffeb3b;
  /* Bright Yellow */
  border: 3px solid #000000;
  border-radius: 4px;
}

/* The block simulates the thickness/back of the stack */
.note-sheet.back {
  top: 10px;
  left: 10px;
  z-index: 1;
  background: #fdd835;
  /* Slightly darker yellow for depth */
}

/* The side depth filling */
.note-sheet-side {
  position: absolute;
  top: 13px;
  /* 3px border + 10px offset */
  right: -3px;
  width: 13px;
  /* 10px offset + 3px border width */
  height: 100%;
  background: #fbc02d;
  z-index: 1;
  /* transform: skewY(45deg); A simpler block approach is safer for now */
  display: none;
  /* Let's stick to the 2-layer illustrative style which handles depth via offset */
}

/* The top curved sheet */
.note-sheet.top {
  top: 0;
  left: 0;
  z-index: 2;
  z-index: 2;
  border-bottom-left-radius: 60px;
  /* The curve */
  display: flex;
  align-items: center;
  justify-content: center;
}

/* The Plus Icon inside the top note */
.note-plus-icon {
  font-size: 64px;
  color: rgba(0, 0, 0, 0.2);
  user-select: none;
  transition: color 0.2s ease;
}

.note-stack:hover .note-plus-icon {
  color: rgba(0, 0, 0, 0.5);
}

.note-stack:hover .note-sheet.top {
  animation: tilt-shaking 0.4s infinite;
}

@keyframes tilt-shaking {
  0% {
    transform: rotate(0deg);
  }

  25% {
    transform: rotate(3deg);
  }

  50% {
    transform: rotate(0deg);
  }

  75% {
    transform: rotate(-3deg);
  }

  100% {
    transform: rotate(0deg);
  }
}

/* Hidden Input for Mobile Keyboard/Clipboard */
.hidden-input {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: default;
  font-size: 16px;
  /* Prevents iOS zoom on focus */
  -webkit-user-select: text;
  user-select: text;
}

/* Sticky Note */
.sticky-note {
  position: absolute;
  width: var(--note-width);
  min-height: var(--note-height);
  background: #ffeb3b;
  /* Bright Yellow to match stack */
  padding: 16px;
  box-shadow: var(--note-shadow);
  border: 3px solid #000000;
  /* Match stack border */
  border-radius: 4px;
  /* Slight radius, but NO large curve */
  font-size: 14px;
  line-height: 1.5;
  word-wrap: break-word;
  transition:
    transform 0.2s ease,
    box-shadow 0.2s ease;
}

.sticky-note:hover {
  transform: translateY(-2px);
  box-shadow:
    0 6px 12px rgba(0, 0, 0, 0.15),
    0 4px 8px rgba(0, 0, 0, 0.1);
}

.sticky-note.editing {
  outline: 2px solid var(--fab-bg);
}

.sticky-note.deleting {
  transform: scale(1.15);
  opacity: 0;
  transition:
    transform 0.3s ease-out,
    opacity 0.3s ease-out;
  pointer-events: none;
}

.note-editor {
  min-height: 100%;
  outline: none;
  cursor: text;
}

/* Selected Note Menu Container */
.selected-note-menu {
  position: absolute;
  width: 180px;
  /* Explicit width to match note */
  display: flex;
  justify-content: space-between;
  align-items: center;
  pointer-events: none;
  z-index: 150;
}

/* Action FABs (inside the menu) */
.action-fab {
  position: static !important;
  /* Force override of .fab's fixed positioning */
  pointer-events: auto;
  flex-shrink: 0;
}

.action-fab .material-icons {
  transition:
    opacity 0.2s ease,
    transform 0.2s ease;
}

/* Delete Button */
.btn-delete {
  /* animation removed */
  transition: transform 0.2s;
}

/* Drag Button */
.btn-drag {
  cursor: grab;
  /* animation removed */
  transition: transform 0.2s;
}

/* Material Design FAB Buttons */
.fab {
  position: fixed;
  width: var(--fab-size);
  height: var(--fab-size);
  border-radius: 50%;
  background: var(--fab-bg);
  color: #ffffff;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  transition:
    background 0.2s ease,
    transform 0.2s ease,
    box-shadow 0.2s ease;
  z-index: 100;
}

.fab:hover {
  background: var(--fab-hover);
  transform: scale(1.05);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.35);
}

.fab:active {
  transform: scale(0.95);
}

.fab .material-icons {
  font-size: 24px;
}

.fab-search {
  bottom: 24px;
  right: 24px;
}

.fab-about {
  bottom: 24px;
  left: 24px;
}

/* Popup Base */
.popup {
  position: fixed;
  background: var(--popup-bg);
  border-radius: 8px;
  box-shadow: var(--popup-shadow);
  z-index: 200;
  animation: popup-appear 0.2s ease;
}

@keyframes popup-appear {
  from {
    opacity: 0;
    transform: scale(0.9);
  }

  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Search Popup */
.popup-search {
  bottom: 96px;
  right: 24px;
  padding: 16px;
  min-width: 280px;
}

.search-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
}

.popup-search input {
  width: 100%;
  padding: 12px 40px 12px 16px;
  border: 1px solid #e0e0e0;
  border-radius: 24px;
  font-size: 16px;
  outline: none;
  transition: border-color 0.2s ease;
}

.popup-search input:focus {
  border-color: var(--fab-bg);
}

.search-clear-btn {
  position: absolute;
  right: 8px;
  background: none;
  border: none;
  cursor: pointer;
  padding: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #757575;
  border-radius: 50%;
  transition: background-color 0.2s ease, color 0.2s ease;
}

.search-clear-btn:hover {
  background-color: rgba(0, 0, 0, 0.08);
  color: #424242;
}

.search-clear-btn .material-icons {
  font-size: 20px;
}

/* About Popup */
.popup-about {
  bottom: 96px;
  left: 24px;
  padding: 20px;
  min-width: 260px;
  max-width: 320px;
}

.popup-about h3 {
  margin: 0 0 12px 0;
  font-size: 18px;
  font-weight: 500;
  color: #212121;
}

.popup-about p {
  margin: 0 0 8px 0;
  font-size: 14px;
  color: #616161;
  line-height: 1.5;
}

.popup-about .version {
  font-size: 12px;
  color: #9e9e9e;
  margin-top: 12px;
}

/* Popup Close Area */
.popup-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 150;
}

/* Note Date Header */
.note-date-header {
  position: absolute;
  top: 4px;
  right: 8px;
  font-size: 0.75rem;
  color: rgba(0, 0, 0, 0.4);
  pointer-events: none;
  font-family: "Roboto", sans-serif;
  z-index: 5;
}

.note-content {
  margin-top: 10px; /* Space for the date header */
  white-space: pre-wrap;
}

/* ================================
   PWA Specific Styles
   ================================ */

/* PWA Install Button */
.pwa-install-button {
  position: fixed;
  bottom: 100px;
  right: 24px;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  background: linear-gradient(135deg, #6200ee, #3700b3);
  color: white;
  border: none;
  border-radius: 28px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(98, 0, 238, 0.4);
  transition: all 0.2s ease;
  z-index: 1000;
  font-family: "Roboto", sans-serif;
}

.pwa-install-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(98, 0, 238, 0.5);
}

.pwa-install-button:active {
  transform: translateY(0);
}

.pwa-install-button .material-icons {
  font-size: 20px;
}

/* PWA Update Banner */
.pwa-update-banner {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  padding: 12px 24px;
  background: linear-gradient(135deg, #00c853, #00a843);
  color: white;
  font-size: 14px;
  font-weight: 500;
  z-index: 10000;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  font-family: "Roboto", sans-serif;
}

.pwa-update-banner .update-btn {
  padding: 8px 16px;
  background: white;
  color: #00a843;
  border: none;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.pwa-update-banner .update-btn:hover {
  background: #f0f0f0;
  transform: scale(1.05);
}

.pwa-update-banner .dismiss-btn {
  padding: 4px;
  background: transparent;
  border: none;
  color: white;
  cursor: pointer;
  opacity: 0.8;
  transition: opacity 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.pwa-update-banner .dismiss-btn:hover {
  opacity: 1;
}

.pwa-update-banner .dismiss-btn .material-icons {
  font-size: 20px;
}

/* Offline Indicator */
.offline-indicator {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 12px 24px;
  background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
  color: white;
  font-size: 14px;
  font-weight: 500;
  z-index: 10000;
  font-family: "Roboto", sans-serif;
}

.offline-indicator .material-icons {
  font-size: 20px;
}

/* Standalone mode adjustments (when installed as PWA) */
@media (display-mode: standalone) {
  /* Add safe area padding for notched devices */
  .white-board {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  /* Hide install button when already installed */
  .pwa-install-button {
    display: none !important;
  }

  /* Adjust FAB positions for safe areas */
  .fab {
    bottom: calc(24px + env(safe-area-inset-bottom));
  }

  .fab-group.right {
    right: calc(24px + env(safe-area-inset-right));
  }

  /* Adjust search and nav for safe areas */
  .nav-bar {
    top: calc(16px + env(safe-area-inset-top));
    right: calc(16px + env(safe-area-inset-right));
  }
}

/* iOS specific adjustments */
@supports (-webkit-touch-callout: none) {
  /* Prevent rubber band scrolling on iOS */
  html, body {
    overscroll-behavior: none;
    -webkit-overflow-scrolling: touch;
  }
  
  /* Fix 100vh issue on iOS */
  .white-board {
    min-height: -webkit-fill-available;
  }
}

/* Android/PWA improvements */
@media screen and (max-width: 768px) {
  .pwa-install-button {
    bottom: 80px;
    right: 16px;
    padding: 10px 16px;
    font-size: 13px;
  }

  .pwa-install-button .install-text {
    display: none;
  }

  .pwa-install-button .material-icons {
    font-size: 24px;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .pwa-install-button {
    background: #6200ee;
    border: 2px solid white;
  }

  .offline-indicator {
    background: #d32f2f;
    border-top: 2px solid white;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .pwa-install-button,
  .pwa-update-banner .update-btn {
    transition: none;
  }
}
